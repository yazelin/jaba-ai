# Proposal: add-personal-chat-features

## Summary
擴充 LINE Bot 1v1 個人對話功能，讓使用者可以透過私訊查詢個人資訊、所屬群組、歷史訂單，並主動清除偏好設定。

## Motivation
目前 1v1 個人對話功能僅支援設定個人偏好（稱呼、飲食限制等），使用者無法：
- 查詢自己目前的偏好設定內容
- 查詢自己所屬的群組列表
- 查詢歷史訂單紀錄
- 主動清除已儲存的偏好設定

這些功能對使用者而言是基本需求，可以增加系統的透明度和使用體驗。

## Scope

### In Scope
1. **查詢偏好設定** - 使用者可以查詢目前儲存的偏好設定
2. **查詢所屬群組** - 使用者可以查詢自己加入的已啟用群組列表
3. **查詢歷史訂單** - 使用者可以查詢過去的訂單紀錄
4. **清除偏好設定** - 使用者可以主動清除所有偏好設定

### Out of Scope
- 修改群組成員資格
- 刪除歷史訂單紀錄
- 匯出訂單資料

## Affected Capabilities
- `line-bot` (MODIFIED) - 擴充個人訊息處理邏輯

## Spec Deltas
- `personal-chat/spec.md` - 新增個人對話查詢功能需求

## Key Decisions
1. **指令觸發方式**: 採用自然語言 + 快捷指令雙軌制
   - 快捷指令：「我的設定」「我的群組」「歷史訂單」「清除設定」
   - 自然語言：AI 理解意圖後執行對應查詢

2. **歷史訂單顯示範圍**: 預設顯示最近 10 筆訂單
   - 避免資訊過載
   - 涵蓋近期活動紀錄

3. **清除設定確認機制**: 直接清除，無需二次確認
   - 偏好設定可隨時重新設定
   - 簡化操作流程

## Dependencies
- 現有的 `User.preferences` JSONB 欄位
- 現有的 `GroupMember` 關聯
- 現有的 `Order` 關聯

## Risks
- **低風險**: 純查詢功能，不影響既有資料
- **低風險**: 清除設定為使用者主動操作，可重新設定
