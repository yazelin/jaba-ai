# Proposal: add-group-admin-store-commands

## Why
目前群組管理員若要變更今日店家，必須進入網頁後台操作。這對於臨時需要換店家的情況不夠即時，尤其是在開單前需要快速決定今天要訂哪家時。

讓群組管理員可以直接在 LINE 群組中透過指令或自然語言來管理今日店家，可以大幅提升操作便利性。

## What Changes

### 新增功能
1. **群組管理員指令** - 管理員在群組中輸入特定指令可管理今日店家
2. **今日店家操作** - 設定、新增、移除、清除今日店家
3. **權限檢查** - 僅限群組管理員可執行這些操作

### 快捷指令
| 指令 | 功能 |
|------|------|
| `今日店家` | 查看目前設定的今日店家 |
| `設定店家 [店名]` | 設定今日店家（清除其他） |
| `加店家 [店名]` | 新增一家今日店家 |
| `移除店家 [店名]` | 移除特定今日店家 |
| `清除店家` | 清除所有今日店家 |

### 自然語言（AI 理解）
- 「今天吃 XXX」→ 設定今日店家
- 「也加 XXX」→ 新增今日店家
- 「不要 XXX 了」→ 移除店家

## Scope

### In Scope
- 群組中管理員指令處理
- 今日店家 CRUD 操作
- 權限檢查（GroupAdmin）
- 非點餐中時回應管理員指令

### Out of Scope
- 新增/編輯店家本身（需在後台操作）
- 菜單管理（需在後台操作）

## Affected Capabilities
- `line-bot` (MODIFIED) - 新增群組管理員指令處理

## Key Decisions
1. **觸發時機**: 非點餐中時，管理員可用指令管理店家；點餐中時只處理點餐
2. **權限模型**: 使用現有的 `GroupAdmin` 表檢查權限
3. **店家驗證**: 只能設定系統中已存在的店家（從 `stores` 表查詢）
4. **店名匹配**: 模糊匹配店家名稱（包含即可），找不到時提示可用店家列表

## Dependencies
- `GroupAdminRepository.is_admin()` - 檢查管理員權限
- `GroupTodayStoreRepository` - 今日店家操作
- `StoreRepository` - 查詢店家

## Risks
- **低風險**: 使用現有 repository 方法，不影響資料結構
