# 功能清單

本文件列出呷爸系統各介面的完整功能。

## 超級管理員後台 (`/admin.html`)

使用帳號密碼登入，擁有系統最高權限。

### 店家管理
| 功能 | 說明 |
|------|------|
| 查看所有店家 | 顯示全局店家和各群組專屬店家 |
| 新增店家 | 透過菜單上傳時自動建立 |
| 編輯店家 | 修改名稱、電話、地址、說明 |
| 啟用/停用店家 | 切換店家狀態 |
| 刪除店家 | 永久刪除店家資料 |
| 上傳菜單 | AI 圖片辨識菜單 |
| 編輯菜單 | 修改辨識結果後儲存 |
| 刪除菜單 | 清除店家菜單（保留店家資料） |

### 群組管理
| 功能 | 說明 |
|------|------|
| 查看所有群組 | 顯示已啟用群組列表 |
| 選擇群組 | 從下拉選單選擇要管理的群組（後續操作都針對此群組） |
| 設定今日店家 | 為**選定群組**設定今日可訂購店家（需先選擇群組，可多選店家） |
| 查看群組訂單 | 顯示**選定群組**的所有訂單 |
| 確認付款 | 標記訂單為已付款 |
| 訂單統計 | 顯示訂單數、總金額、已收/待收、品項統計 |

### 群組申請審核
| 功能 | 說明 |
|------|------|
| 查看待審核申請 | 顯示所有 pending 申請 |
| 審核申請 | 通過或拒絕申請，可加備註 |

### AI 提示詞管理
| 功能 | 說明 |
|------|------|
| 查看提示詞 | 顯示所有 AI 提示詞 |
| 編輯提示詞 | 修改提示詞內容（會清除快取） |

### 系統維護
| 功能 | 說明 |
|------|------|
| 對話統計 | 顯示訊息總數、超過一年的數量 |
| 清理舊訊息 | 刪除超過指定天數的對話記錄 |
| LINE Bot 狀態 | 顯示 LINE Bot 連線狀態 |

### AI 助手對話
| 功能 | 說明 |
|------|------|
| 與呷爸對話 | 管理模式 AI 對話 |
| 設定今日店家 | 透過對話設定（如「今天吃 XXX」） |
| 新增/移除店家 | 透過對話操作今日店家 |

---

## LINE 群組管理後台 (`/line-admin.html`)

使用群組代碼登入，僅能管理該代碼關聯的群組。

### 店家管理
| 功能 | 說明 |
|------|------|
| 查看店家 | 顯示全局店家 + 群組專屬店家 |
| 新增專屬店家 | 建立群組專屬店家 |
| 編輯專屬店家 | 修改群組專屬店家（全局店家無法編輯） |
| 啟用/停用專屬店家 | 切換群組專屬店家狀態 |
| 刪除專屬店家 | 刪除群組專屬店家 |
| 上傳菜單 | 為專屬店家上傳菜單（AI 辨識） |
| 編輯菜單 | 修改專屬店家菜單 |

### 群組管理
| 功能 | 說明 |
|------|------|
| 選擇群組 | 切換管理的群組（同一代碼可能關聯多群組） |
| 設定今日店家 | 設定群組今日可訂購店家（多選） |
| 查看今日訂單 | 顯示群組今日訂單 |
| 確認收款 | 標記訂單為已付款 |

### 安全設定
| 功能 | 說明 |
|------|------|
| 變更群組代碼 | 修改登入用的群組代碼 |

---

## LINE 個人聊天

與呷爸私訊對話，需先加入已啟用的群組才能使用。

### 偏好設定（透過 AI 對話）
| 功能 | 說明 |
|------|------|
| 設定稱呼 | 告訴呷爸你的稱呼（如「叫我小明」） |
| 設定飲食限制 | 告訴呷爸不吃的東西（如「我不吃辣」） |
| 設定口味偏好 | 告訴呷爸喜好（如「我喜歡清淡」） |

### 快捷指令
| 指令 | 說明 |
|------|------|
| `我的設定` / `設定` / `偏好` | 查看目前偏好設定 |
| `我的群組` / `群組` | 查看所屬群組列表 |
| `歷史訂單` / `我的訂單` | 查看最近 10 筆訂單紀錄 |
| `清除設定` | 清除所有偏好設定 |
| `help` / `jaba` / `呷爸` | 顯示幫助訊息 |
| `id` / `userid` | 顯示用戶 ID |

---

## LINE 群組聊天

在 LINE 群組中進行團體訂餐，需群組已啟用。

### 一般指令（所有成員可用）
| 指令 | 說明 |
|------|------|
| `開單` | 開始群組點餐（需已設定今日店家） |
| `收單` / `結單` | 結束點餐並顯示摘要 |
| `菜單` | 查看今日店家菜單 |
| `目前訂單` / `訂單` | 查看目前點餐狀況 |
| `+1` / `我也要` | 跟單（點和上一位相同的餐點） |
| `help` / `jaba` / `呷爸` / `@jaba` / `@呷爸` | 顯示幫助訊息 |
| `id` / `群組id` / `groupid` / `userid` | 顯示群組 ID 和用戶 ID |

### 點餐中（AI 對話）
| 功能 | 說明 |
|------|------|
| 直接說餐點 | 如「雞腿便當」、「排骨飯不要酸菜」 |
| 修改訂單 | 如「改成魚排」、「取消訂單」 |
| 代點 | 如「幫小明點滷肉飯」 |
| 查詢 | 如「我點了什麼」、「小明點了什麼」 |

### 管理員指令（需先綁定）
| 指令 | 說明 |
|------|------|
| `管理員 [代碼]` | 綁定為群組管理員 |
| `解除管理員` | 解除管理員身份（需有其他管理員） |
| `今日` | 查看今日店家設定 |
| 直接輸入店名 | 設定為今日店家（取代原有） |
| `加 [店名]` | 新增今日店家 |
| `移除 [店名]` | 移除今日店家 |
| `清除` | 清除所有今日店家 |

---

## 功能對照表

| 功能 | 超管後台 | LINE 管後台 | LINE 個人 | LINE 群組 |
|------|:--------:|:-----------:|:---------:|:---------:|
| 店家管理（全局） | ✅ | ❌（唯讀） | ❌ | ❌ |
| 店家管理（專屬） | ✅ | ✅ | ❌ | ❌ |
| 菜單上傳/編輯 | ✅ | ✅（專屬） | ❌ | ❌ |
| 今日店家設定 | ✅ | ✅ | ❌ | ✅（管理員） |
| 查看訂單 | ✅ | ✅ | ✅（歷史） | ✅ |
| 確認付款 | ✅ | ✅ | ❌ | ❌ |
| 群組申請審核 | ✅ | ❌ | ❌ | ❌ |
| AI 提示詞管理 | ✅ | ❌ | ❌ | ❌ |
| 系統維護 | ✅ | ❌ | ❌ | ❌ |
| 個人偏好設定 | ❌ | ❌ | ✅ | ❌ |
| 點餐 | ❌ | ❌ | ❌ | ✅ |
| 代點 | ❌ | ❌ | ❌ | ✅ |
| 開單/收單 | ❌ | ❌ | ❌ | ✅ |

---

## 注意事項

1. **個人偏好設定**：只能在 LINE 私聊呷爸時設定，管理後台無此功能
2. **訂餐功能**：只能在 LINE 群組中進行，管理後台只能查看訂單
3. **代點功能**：在 LINE 群組點餐時說「幫 XXX 點」即可
4. **群組專屬店家**：由 LINE 群組管理員建立，僅該群組可使用
5. **全局店家**：由超級管理員建立，所有群組都可使用

---

## 即時看板 (`/board.html`)

公開的看板頁面，用於顯示即時訂單資訊。

| 功能 | 說明 |
|------|------|
| 群組選擇 | 下拉選單選擇要查看的群組（或全部） |
| 今日店家 | 顯示當前選定群組的今日店家 |
| 訂單列表 | 即時顯示所有訂單（含付款狀態） |
| 品項統計 | 統計各品項的訂購數量 |
| 總金額 | 顯示已收/待收金額 |
| 聊天預覽 | 顯示最近的聊天訊息 |
| 群組申請 | 點擊「申請開通」提交新群組申請 |

**即時更新**：看板頁面透過 Socket.IO 接收即時更新，無需重新整理。
